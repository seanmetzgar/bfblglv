jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(e,t,a,l,n){return jQuery.easing[jQuery.easing.def](e,t,a,l,n)},easeInQuad:function(e,t,a,l,n){return l*(t/=n)*t+a},easeOutQuad:function(e,t,a,l,n){return-l*(t/=n)*(t-2)+a},easeInOutQuad:function(e,t,a,l,n){return(t/=n/2)<1?l/2*t*t+a:-l/2*(--t*(t-2)-1)+a},easeInCubic:function(e,t,a,l,n){return l*(t/=n)*t*t+a},easeOutCubic:function(e,t,a,l,n){return l*((t=t/n-1)*t*t+1)+a},easeInOutCubic:function(e,t,a,l,n){return(t/=n/2)<1?l/2*t*t*t+a:l/2*((t-=2)*t*t+2)+a},easeInQuart:function(e,t,a,l,n){return l*(t/=n)*t*t*t+a},easeOutQuart:function(e,t,a,l,n){return-l*((t=t/n-1)*t*t*t-1)+a},easeInOutQuart:function(e,t,a,l,n){return(t/=n/2)<1?l/2*t*t*t*t+a:-l/2*((t-=2)*t*t*t-2)+a},easeInQuint:function(e,t,a,l,n){return l*(t/=n)*t*t*t*t+a},easeOutQuint:function(e,t,a,l,n){return l*((t=t/n-1)*t*t*t*t+1)+a},easeInOutQuint:function(e,t,a,l,n){return(t/=n/2)<1?l/2*t*t*t*t*t+a:l/2*((t-=2)*t*t*t*t+2)+a},easeInSine:function(e,t,a,l,n){return-l*Math.cos(t/n*(Math.PI/2))+l+a},easeOutSine:function(e,t,a,l,n){return l*Math.sin(t/n*(Math.PI/2))+a},easeInOutSine:function(e,t,a,l,n){return-l/2*(Math.cos(Math.PI*t/n)-1)+a},easeInExpo:function(e,t,a,l,n){return 0==t?a:l*Math.pow(2,10*(t/n-1))+a},easeOutExpo:function(e,t,a,l,n){return t==n?a+l:l*(-Math.pow(2,-10*t/n)+1)+a},easeInOutExpo:function(e,t,a,l,n){return 0==t?a:t==n?a+l:(t/=n/2)<1?l/2*Math.pow(2,10*(t-1))+a:l/2*(-Math.pow(2,-10*--t)+2)+a},easeInCirc:function(e,t,a,l,n){return-l*(Math.sqrt(1-(t/=n)*t)-1)+a},easeOutCirc:function(e,t,a,l,n){return l*Math.sqrt(1-(t=t/n-1)*t)+a},easeInOutCirc:function(e,t,a,l,n){return(t/=n/2)<1?-l/2*(Math.sqrt(1-t*t)-1)+a:l/2*(Math.sqrt(1-(t-=2)*t)+1)+a},easeInElastic:function(e,t,a,l,n){var i=1.70158,o=0,s=l;if(0==t)return a;if(1==(t/=n))return a+l;if(o||(o=.3*n),s<Math.abs(l)){s=l;var i=o/4}else var i=o/(2*Math.PI)*Math.asin(l/s);return-(s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-i)*Math.PI/o))+a},easeOutElastic:function(e,t,a,l,n){var i=1.70158,o=0,s=l;if(0==t)return a;if(1==(t/=n))return a+l;if(o||(o=.3*n),s<Math.abs(l)){s=l;var i=o/4}else var i=o/(2*Math.PI)*Math.asin(l/s);return s*Math.pow(2,-10*t)*Math.sin(2*(t*n-i)*Math.PI/o)+l+a},easeInOutElastic:function(e,t,a,l,n){var i=1.70158,o=0,s=l;if(0==t)return a;if(2==(t/=n/2))return a+l;if(o||(o=.3*n*1.5),s<Math.abs(l)){s=l;var i=o/4}else var i=o/(2*Math.PI)*Math.asin(l/s);return 1>t?-.5*s*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-i)*Math.PI/o)+a:s*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*n-i)*Math.PI/o)*.5+l+a},easeInBack:function(e,t,a,l,n,i){return void 0==i&&(i=1.70158),l*(t/=n)*t*((i+1)*t-i)+a},easeOutBack:function(e,t,a,l,n,i){return void 0==i&&(i=1.70158),l*((t=t/n-1)*t*((i+1)*t+i)+1)+a},easeInOutBack:function(e,t,a,l,n,i){return void 0==i&&(i=1.70158),(t/=n/2)<1?l/2*t*t*(((i*=1.525)+1)*t-i)+a:l/2*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)+a},easeInBounce:function(e,t,a,l,n){return l-jQuery.easing.easeOutBounce(e,n-t,0,l,n)+a},easeOutBounce:function(e,t,a,l,n){return(t/=n)<1/2.75?7.5625*l*t*t+a:2/2.75>t?l*(7.5625*(t-=1.5/2.75)*t+.75)+a:2.5/2.75>t?l*(7.5625*(t-=2.25/2.75)*t+.9375)+a:l*(7.5625*(t-=2.625/2.75)*t+.984375)+a},easeInOutBounce:function(e,t,a,l,n){return n/2>t?.5*jQuery.easing.easeInBounce(e,2*t,0,l,n)+a:.5*jQuery.easing.easeOutBounce(e,2*t-n,0,l,n)+.5*l+a}});
jQuery.trumbowyg={langs:{en:{viewHTML:"View HTML",undo:"Undo",redo:"Redo",formatting:"Formatting",p:"Paragraph",blockquote:"Quote",code:"Code",header:"Header",bold:"Bold",italic:"Italic",strikethrough:"Stroke",underline:"Underline",strong:"Strong",em:"Emphasis",del:"Deleted",superscript:"Superscript",subscript:"Subscript",unorderedList:"Unordered list",orderedList:"Ordered list",insertImage:"Insert Image",link:"Link",createLink:"Insert link",unlink:"Remove link",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",horizontalRule:"Insert horizontal rule",removeformat:"Remove format",fullscreen:"Fullscreen",close:"Close",submit:"Confirm",reset:"Cancel",required:"Required",description:"Description",title:"Title",text:"Text",target:"Target"}},plugins:{},svgPath:null},function(e,t,a,n){"use strict";n.fn.trumbowyg=function(e,t){var a="trumbowyg";if(e===Object(e)||!e)return this.each(function(){n(this).data(a)||n(this).data(a,new l(this,e))});if(1===this.length)try{var i=n(this).data(a);switch(e){case"execCmd":return i.execCmd(t.cmd,t.param,t.forceCss);case"openModal":return i.openModal(t.title,t.content);case"closeModal":return i.closeModal();case"openModalInsert":return i.openModalInsert(t.title,t.fields,t.callback);case"saveRange":return i.saveRange();case"getRange":return i.range;case"getRangeText":return i.getRangeText();case"restoreRange":return i.restoreRange();case"enable":return i.toggleDisable(!1);case"disable":return i.toggleDisable(!0);case"destroy":return i.destroy();case"empty":return i.empty();case"html":return i.html(t)}}catch(o){}return!1};var l=function(e,l){var i=this,o="trumbowyg-icons";i.doc=e.ownerDocument||a,i.$ta=n(e),i.$c=n(e),l=l||{},null!=l.lang||null!=n.trumbowyg.langs[l.lang]?i.lang=n.extend(!0,{},n.trumbowyg.langs.en,n.trumbowyg.langs[l.lang]):i.lang=n.trumbowyg.langs.en;var r=null!=n.trumbowyg.svgPath?n.trumbowyg.svgPath:l.svgPath;if(i.hasSvg=r!==!1,i.svgPath=i.doc.querySelector("base")?t.location:"",0===n("#"+o,i.doc).length&&r!==!1){if(null==r)try{throw new Error}catch(s){var c=s.stack.split("\n");for(var d in c)if(c[d].match(/http[s]?:\/\//)){r=c[Number(d)].match(/((http[s]?:\/\/.+\/)([^\/]+\.js)):/)[1].split("/"),r.pop(),r=r.join("/")+"/ui/icons.svg";break}}var u=i.doc.createElement("div");u.id=o,i.doc.body.insertBefore(u,i.doc.body.childNodes[0]),n.get(r,function(e){u.innerHTML=(new XMLSerializer).serializeToString(e.documentElement)})}var p=i.lang.header,h=function(){return(t.chrome||t.Intl&&Intl.v8BreakIterator)&&"CSS"in t};i.btnsDef={viewHTML:{fn:"toggle"},undo:{isSupported:h,key:"Z"},redo:{isSupported:h,key:"Y"},p:{fn:"formatBlock"},blockquote:{fn:"formatBlock"},h1:{fn:"formatBlock",title:p+" 1"},h2:{fn:"formatBlock",title:p+" 2"},h3:{fn:"formatBlock",title:p+" 3"},h4:{fn:"formatBlock",title:p+" 4"},subscript:{tag:"sub"},superscript:{tag:"sup"},bold:{key:"B"},italic:{key:"I"},underline:{tag:"u"},strikethrough:{tag:"strike"},strong:{fn:"bold",key:"B"},em:{fn:"italic",key:"I"},del:{fn:"strikethrough"},createLink:{key:"K",tag:"a"},unlink:{},insertImage:{},justifyLeft:{tag:"left",forceCss:!0},justifyCenter:{tag:"center",forceCss:!0},justifyRight:{tag:"right",forceCss:!0},justifyFull:{tag:"justify",forceCss:!0},unorderedList:{fn:"insertUnorderedList",tag:"ul"},orderedList:{fn:"insertOrderedList",tag:"ol"},horizontalRule:{fn:"insertHorizontalRule"},removeformat:{},fullscreen:{"class":"trumbowyg-not-disable"},close:{fn:"destroy","class":"trumbowyg-not-disable"},formatting:{dropdown:["p","blockquote","h1","h2","h3","h4"],ico:"p"},link:{dropdown:["createLink","unlink"]}},i.o=n.extend(!0,{},{lang:"en",fixedBtnPane:!1,fixedFullWidth:!1,autogrow:!1,prefix:"trumbowyg-",semantic:!0,resetCss:!1,removeformatPasted:!1,tagsToRemove:[],btnsGrps:{design:["bold","italic","underline","strikethrough"],semantic:["strong","em","del"],justify:["justifyLeft","justifyCenter","justifyRight","justifyFull"],lists:["unorderedList","orderedList"]},btns:[["viewHTML"],["undo","redo"],["formatting"],"btnGrp-semantic",["superscript","subscript"],["link"],["insertImage"],"btnGrp-justify","btnGrp-lists",["horizontalRule"],["removeformat"],["fullscreen"]],btnsDef:{},inlineElementsSelector:"a,abbr,acronym,b,caption,cite,code,col,dfn,dir,dt,dd,em,font,hr,i,kbd,li,q,span,strikeout,strong,sub,sup,u",pasteHandlers:[],imgDblClickHandler:function(){var e=n(this),t=e.attr("src"),a="(Base64)";return 0===t.indexOf("data:image")&&(t=a),i.openModalInsert(i.lang.insertImage,{url:{label:"URL",value:t,required:!0},alt:{label:i.lang.description,value:e.attr("alt")}},function(t){return t.src!==a&&e.attr({src:t.src}),e.attr({alt:t.alt}),!0}),!1},plugins:{}},l),i.disabled=i.o.disabled||"TEXTAREA"===e.nodeName&&e.disabled,l.btns?i.o.btns=l.btns:i.o.semantic||(i.o.btns[4]="btnGrp-design"),n.each(i.o.btnsDef,function(e,t){i.addBtnDef(e,t)}),i.keys=[],i.tagToButton={},i.tagHandlers=[],i.pasteHandlers=[].concat(i.o.pasteHandlers),i.init()};l.prototype={init:function(){var e=this;e.height=e.$ta.height(),e.initPlugins(),e.doc.execCommand("enableObjectResizing",!1,!1),e.doc.execCommand("defaultParagraphSeparator",!1,"p"),e.buildEditor(),e.buildBtnPane(),e.fixedBtnPaneEvents(),e.buildOverlay(),setTimeout(function(){e.disabled&&e.toggleDisable(!0),e.$c.trigger("tbwinit")})},addBtnDef:function(e,t){this.btnsDef[e]=t},buildEditor:function(){var e=this,a=e.o.prefix,l="";e.$box=n("<div/>",{"class":a+"box "+a+"editor-visible "+a+e.o.lang+" trumbowyg"}),e.isTextarea=e.$ta.is("textarea"),e.isTextarea?(l=e.$ta.val(),e.$ed=n("<div/>"),e.$box.insertAfter(e.$ta).append(e.$ed,e.$ta)):(e.$ed=e.$ta,l=e.$ed.html(),e.$ta=n("<textarea/>",{name:e.$ta.attr("id"),height:e.height}).val(l),e.$box.insertAfter(e.$ed).append(e.$ta,e.$ed),e.syncCode()),e.$ta.addClass(a+"textarea").attr("tabindex",-1),e.$ed.addClass(a+"editor").attr({contenteditable:!0,dir:e.lang._dir||"ltr"}).html(l),e.o.tabindex&&e.$ed.attr("tabindex",e.o.tabindex),e.$c.is("[placeholder]")&&e.$ed.attr("placeholder",e.$c.attr("placeholder")),e.o.resetCss&&e.$ed.addClass(a+"reset-css"),e.o.autogrow||e.$ta.add(e.$ed).css({height:e.height}),e.semanticCode(),e._ctrl=!1,e.$ed.on("dblclick","img",e.o.imgDblClickHandler).on("keydown",function(t){if(e._composition=229===t.which,t.ctrlKey){e._ctrl=!0;var a=e.keys[String.fromCharCode(t.which).toUpperCase()];try{return e.execCmd(a.fn,a.param),!1}catch(n){}}}).on("keyup",function(t){t.which>=37&&t.which<=40||(!t.ctrlKey||89!==t.which&&90!==t.which?e._ctrl||17===t.which||e._composition||(e.semanticCode(!1,13===t.which),e.$c.trigger("tbwchange")):e.$c.trigger("tbwchange"),setTimeout(function(){e._ctrl=!1},200))}).on("mouseup keydown keyup",function(){e.updateButtonPaneStatus()}).on("focus blur",function(t){e.$c.trigger("tbw"+t.type),"blur"===t.type&&n("."+a+"active-button",e.$btnPane).removeClass(a+"active-button "+a+"active")}).on("cut",function(){e.$c.trigger("tbwchange")}).on("paste",function(a){if(e.o.removeformatPasted){a.preventDefault();try{var l=t.clipboardData.getData("Text");try{e.doc.selection.createRange().pasteHTML(l)}catch(i){e.doc.getSelection().getRangeAt(0).insertNode(e.doc.createTextNode(l))}}catch(o){e.execCmd("insertText",(a.originalEvent||a).clipboardData.getData("text/plain"))}}n.each(e.pasteHandlers,function(e,t){t(a)}),setTimeout(function(){e.o.semantic?e.semanticCode(!1,!0):e.syncCode(),e.$c.trigger("tbwpaste",a)},0)}),e.$ta.on("keyup paste",function(){e.$c.trigger("tbwchange")}),n(e.doc).on("keydown",function(t){return 27===t.which?(e.closeModal(),!1):void 0})},buildBtnPane:function(){var e=this,t=e.o.prefix,a=e.$btnPane=n("<div/>",{"class":t+"button-pane"});n.each(e.o.btns,function(l,i){try{var o=i.split("btnGrp-");null!=o[1]&&(i=e.o.btnsGrps[o[1]])}catch(r){}n.isArray(i)||(i=[i]);var s=n("<div/>",{"class":t+"button-group "+(i.indexOf("fullscreen")>=0?t+"right":"")});n.each(i,function(t,a){try{var n;e.isSupportedBtn(a)&&(n=e.buildBtn(a)),s.append(n)}catch(l){}}),a.append(s)}),e.$box.prepend(a)},buildBtn:function(e){var t=this,a=t.o.prefix,l=t.btnsDef[e],i=l.dropdown,o=t.lang[e]||e,r=n("<button/>",{type:"button","class":a+e+"-button "+(l["class"]||""),html:t.hasSvg?'<svg><use xlink:href="'+t.svgPath+"#"+a+(l.ico||e).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>':"",title:(l.title||l.text||o)+(l.key?" (Ctrl + "+l.key+")":""),tabindex:-1,mousedown:function(){return(!i||n("."+e+"-"+a+"dropdown",t.$box).is(":hidden"))&&n("body",t.doc).trigger("mousedown"),!t.$btnPane.hasClass(a+"disable")||n(this).hasClass(a+"active")||n(this).hasClass(a+"not-disable")?(t.execCmd((i?"dropdown":!1)||l.fn||e,l.param||e,l.forceCss||!1),!1):!1}});if(i){r.addClass(a+"open-dropdown");var s=a+"dropdown",c=n("<div/>",{"class":s+"-"+e+" "+s+" "+a+"fixed-top","data-dropdown":e});n.each(i,function(e,a){t.btnsDef[a]&&t.isSupportedBtn(a)&&c.append(t.buildSubBtn(a))}),t.$box.append(c.hide())}else l.key&&(t.keys[l.key]={fn:l.fn||e,param:l.param||e});return i||(t.tagToButton[(l.tag||e).toLowerCase()]=e),r},buildSubBtn:function(e){var t=this,a=t.o.prefix,l=t.btnsDef[e];return l.key&&(t.keys[l.key]={fn:l.fn||e,param:l.param||e}),t.tagToButton[(l.tag||e).toLowerCase()]=e,n("<button/>",{type:"button","class":a+e+"-dropdown-button"+(l.ico?" "+a+l.ico+"-button":""),html:t.hasSvg?'<svg><use xlink:href="'+t.svgPath+"#"+a+(l.ico||e).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>'+(l.text||l.title||t.lang[e]||e):"",title:l.key?" (Ctrl + "+l.key+")":null,style:l.style||null,mousedown:function(){return n("body",t.doc).trigger("mousedown"),t.execCmd(l.fn||e,l.param||e,l.forceCss||!1),!1}})},isSupportedBtn:function(e){try{return this.btnsDef[e].isSupported()}catch(t){}return!0},buildOverlay:function(){var e=this;return e.$overlay=n("<div/>",{"class":e.o.prefix+"overlay"}).css({top:e.$btnPane.outerHeight(),height:e.$ed.outerHeight()+1+"px"}).appendTo(e.$box),e.$overlay},showOverlay:function(){var e=this;n(t).trigger("scroll"),e.$overlay.fadeIn(200),e.$box.addClass(e.o.prefix+"box-blur")},hideOverlay:function(){var e=this;e.$overlay.fadeOut(50),e.$box.removeClass(e.o.prefix+"box-blur")},fixedBtnPaneEvents:function(){var e=this,a=e.o.fixedFullWidth,l=e.$box;e.o.fixedBtnPane&&(e.isFixed=!1,n(t).on("scroll resize",function(){if(l){e.syncCode();var i=n(t).scrollTop(),o=l.offset().top+1,r=e.$btnPane,s=r.outerHeight()-2;i-o>0&&i-o-e.height<0?(e.isFixed||(e.isFixed=!0,r.css({position:"fixed",top:0,left:a?"0":"auto",zIndex:7}),n([e.$ta,e.$ed]).css({marginTop:r.height()})),r.css({width:a?"100%":l.width()-1+"px"}),n("."+e.o.prefix+"fixed-top",l).css({position:a?"fixed":"absolute",top:a?s:s+(i-o)+"px",zIndex:15})):e.isFixed&&(e.isFixed=!1,r.removeAttr("style"),n([e.$ta,e.$ed]).css({marginTop:0}),n("."+e.o.prefix+"fixed-top",l).css({position:"absolute",top:s}))}}))},toggleDisable:function(e){var t=this,a=t.o.prefix;t.disabled=e,e?t.$ta.attr("disabled",!0):t.$ta.removeAttr("disabled"),t.$box.toggleClass(a+"disabled",e),t.$ed.attr("contenteditable",!e)},destroy:function(){var e=this,t=e.o.prefix,a=e.height;e.$box.after(e.isTextarea?e.$ta.css({height:a}).val(e.html()).removeClass(t+"textarea").show():e.$ed.css({height:a}).removeClass(t+"editor").removeAttr("contenteditable").html(e.html()).show()),e.$ed.off("dblclick","img"),e.destroyPlugins(),e.$box.remove(),e.$c.removeData("trumbowyg"),n("body").removeClass(t+"body-fullscreen")},empty:function(){this.$ta.val(""),this.syncCode(!0)},toggle:function(){var e=this,t=e.o.prefix;e.semanticCode(!1,!0),setTimeout(function(){e.doc.activeElement.blur(),e.$box.toggleClass(t+"editor-hidden "+t+"editor-visible"),e.$btnPane.toggleClass(t+"disable"),n("."+t+"viewHTML-button",e.$btnPane).toggleClass(t+"active"),e.$box.hasClass(t+"editor-visible")?e.$ta.attr("tabindex",-1):e.$ta.removeAttr("tabindex")},0)},dropdown:function(e){var a=this,l=a.doc,i=a.o.prefix,o=n("[data-dropdown="+e+"]",a.$box),r=n("."+i+e+"-button",a.$btnPane),s=o.is(":hidden");if(n("body",l).trigger("mousedown"),s){var c=r.offset().left;r.addClass(i+"active"),o.css({position:"absolute",top:r.offset().top-a.$btnPane.offset().top+r.outerHeight(),left:a.o.fixedFullWidth&&a.isFixed?c+"px":c-a.$btnPane.offset().left+"px"}).show(),n(t).trigger("scroll"),n("body",l).on("mousedown",function(){n("."+i+"dropdown",l).hide(),n("."+i+"active",l).removeClass(i+"active"),n("body",l).off("mousedown")})}},html:function(e){var t=this;return null!=e?(t.$ta.val(e),t.syncCode(!0),t):t.$ta.val()},syncTextarea:function(){var e=this;e.$ta.val(e.$ed.text().trim().length>0||e.$ed.find("hr,img,embed,input").length>0?e.$ed.html():"")},syncCode:function(e){var t=this;!e&&t.$ed.is(":visible")?t.syncTextarea():t.$ed.html(t.$ta.val()),t.o.autogrow&&(t.height=t.$ed.height(),t.height!==t.$ta.css("height")&&(t.$ta.css({height:t.height}),t.$c.trigger("tbwresize")))},semanticCode:function(e,t){var a=this;if(a.saveRange(),a.syncCode(e),n(a.o.tagsToRemove.join(","),a.$ed).remove(),a.o.semantic){if(a.semanticTag("b","strong"),a.semanticTag("i","em"),a.semanticTag("strike","del"),t){var l=a.o.inlineElementsSelector,i=":not("+l+")";a.$ed.contents().filter(function(){return 3===this.nodeType&&this.nodeValue.trim().length>0}).wrap("<span data-tbw/>");var o=function(e){if(0!==e.length){var t=e.nextUntil(i).andSelf().wrapAll("<p/>").parent(),a=t.nextAll(l).first();t.next("br").remove(),o(a)}};o(a.$ed.children(l).first()),a.semanticTag("div","p",!0),a.$ed.find("p").filter(function(){return a.range&&this===a.range.startContainer?!1:0===n(this).text().trim().length&&0===n(this).children().not("br,span").length}).contents().unwrap(),n("[data-tbw]",a.$ed).contents().unwrap(),a.$ed.find("p:empty").remove()}a.restoreRange(),a.syncTextarea()}},semanticTag:function(e,t,a){n(e,this.$ed).each(function(){var e=n(this);e.wrap("<"+t+"/>"),a&&n.each(e.prop("attributes"),function(){e.parent().attr(this.name,this.value)}),e.contents().unwrap()})},createLink:function(){for(var e,t,a,l=this,i=l.doc.getSelection(),o=i.focusNode;["A","DIV"].indexOf(o.nodeName)<0;)o=o.parentNode;if(o&&"A"===o.nodeName){var r=n(o);e=r.attr("href"),t=r.attr("title"),a=r.attr("target");var s=l.doc.createRange();s.selectNode(o),i.addRange(s)}l.saveRange(),l.openModalInsert(l.lang.createLink,{url:{label:"URL",required:!0,value:e},title:{label:l.lang.title,value:t},text:{label:l.lang.text,value:l.getRangeText()},target:{label:l.lang.target,value:a}},function(e){var t=n(['<a href="',e.url,'">',e.text,"</a>"].join(""));return e.title.length>0&&t.attr("title",e.title),e.target.length>0&&t.attr("target",e.target),l.range.deleteContents(),l.range.insertNode(t[0]),!0})},unlink:function(){var e=this,t=e.doc.getSelection(),a=t.focusNode;if(t.isCollapsed){for(;["A","DIV"].indexOf(a.nodeName)<0;)a=a.parentNode;if(a&&"A"===a.nodeName){var n=e.doc.createRange();n.selectNode(a),t.addRange(n)}}e.execCmd("unlink",void 0,void 0,!0)},insertImage:function(){var e=this;e.saveRange(),e.openModalInsert(e.lang.insertImage,{url:{label:"URL",required:!0},alt:{label:e.lang.description,value:e.getRangeText()}},function(t){return e.execCmd("insertImage",t.url),n('img[src="'+t.url+'"]:not([alt])',e.$box).attr("alt",t.alt),!0})},fullscreen:function(){var e,a=this,l=a.o.prefix,i=l+"fullscreen";a.$box.toggleClass(i),e=a.$box.hasClass(i),n("body").toggleClass(l+"body-fullscreen",e),n(t).trigger("scroll"),a.$c.trigger("tbw"+(e?"open":"close")+"fullscreen")},execCmd:function(t,a,n,l){var i=this;l=!!l||"","dropdown"!==t&&i.$ed.focus(),i.doc.execCommand("styleWithCSS",!1,n||!1);try{i[t+l](a)}catch(o){try{t(a)}catch(r){"insertHorizontalRule"===t?a=void 0:"formatBlock"!==t||-1===e.userAgent.indexOf("MSIE")&&-1===e.appVersion.indexOf("Trident/")||(a="<"+a+">"),i.doc.execCommand(t,!1,a),i.syncCode(),i.semanticCode(!1,!0)}"dropdown"!==t&&(i.updateButtonPaneStatus(),i.$c.trigger("tbwchange"))}},openModal:function(e,a){var l=this,i=l.o.prefix;if(n("."+i+"modal-box",l.$box).length>0)return!1;l.saveRange(),l.showOverlay(),l.$btnPane.addClass(i+"disable");var o=n("<div/>",{"class":i+"modal "+i+"fixed-top"}).css({top:l.$btnPane.height()}).appendTo(l.$box);l.$overlay.one("click",function(){return o.trigger("tbwcancel"),!1});var r=n("<form/>",{action:"",html:a}).on("submit",function(){return o.trigger("tbwconfirm"),!1}).on("reset",function(){return o.trigger("tbwcancel"),!1}),s=n("<div/>",{"class":i+"modal-box",html:r}).css({top:"-"+l.$btnPane.outerHeight()+"px",opacity:0}).appendTo(o).animate({top:0,opacity:1},100);return n("<span/>",{text:e,"class":i+"modal-title"}).prependTo(s),o.height(s.outerHeight()+10),n("input:first",s).focus(),l.buildModalBtn("submit",s),l.buildModalBtn("reset",s),n(t).trigger("scroll"),o},buildModalBtn:function(e,t){var a=this,l=a.o.prefix;return n("<button/>",{"class":l+"modal-button "+l+"modal-"+e,type:e,text:a.lang[e]||e}).appendTo(n("form",t))},closeModal:function(){var e=this,t=e.o.prefix;e.$btnPane.removeClass(t+"disable"),e.$overlay.off();var a=n("."+t+"modal-box",e.$box);a.animate({top:"-"+a.height()},100,function(){a.parent().remove(),e.hideOverlay()}),e.restoreRange()},openModalInsert:function(e,t,a){var l=this,i=l.o.prefix,o=l.lang,r="",s="tbwconfirm";return n.each(t,function(e,t){var a=t.label,n=t.name||e;r+='<label><input type="'+(t.type||"text")+'" name="'+n+'" value="'+(t.value||"").replace(/"/g,"&quot;")+'"><span class="'+i+'input-infos"><span>'+(a?o[a]?o[a]:a:o[e]?o[e]:e)+"</span></span></label>"}),l.openModal(e,r).on(s,function(){var e=n("form",n(this)),i=!0,o={};n.each(t,function(t,a){var r=n('input[name="'+t+'"]',e);o[t]=n.trim(r.val()),a.required&&""===o[t]?(i=!1,l.addErrorOnModalField(r,l.lang.required)):a.pattern&&!a.pattern.test(o[t])&&(i=!1,l.addErrorOnModalField(r,a.patternError))}),i&&(l.restoreRange(),a(o,t)&&(l.syncCode(),l.$c.trigger("tbwchange"),l.closeModal(),n(this).off(s)))}).one("tbwcancel",function(){n(this).off(s),l.closeModal()})},addErrorOnModalField:function(e,t){var a=this.o.prefix,l=e.parent();e.on("change keyup",function(){l.removeClass(a+"input-error")}),l.addClass(a+"input-error").find("input+span").append(n("<span/>",{"class":a+"msg-error",text:t}))},saveRange:function(){var e=this,t=e.doc.getSelection();if(e.range=null,t.rangeCount){var a,n=e.range=t.getRangeAt(0),l=e.doc.createRange();l.selectNodeContents(e.$ed[0]),l.setEnd(n.startContainer,n.startOffset),a=(l+"").length,e.metaRange={start:a,end:a+(n+"").length}}},restoreRange:function(){var e,t=this,a=t.metaRange,n=t.range,l=t.doc.getSelection();if(n){if(a&&a.start!==a.end){var i,o=0,r=[t.$ed[0]],s=!1,c=!1;for(e=t.doc.createRange();!c&&(i=r.pop());)if(3===i.nodeType){var d=o+i.length;!s&&a.start>=o&&a.start<=d&&(e.setStart(i,a.start-o),s=!0),s&&a.end>=o&&a.end<=d&&(e.setEnd(i,a.end-o),c=!0),o=d}else for(var u=i.childNodes,p=u.length;p>0;)p-=1,r.push(u[p])}l.removeAllRanges(),l.addRange(e||n)}},getRangeText:function(){return this.range+""},updateButtonPaneStatus:function(){var e=this,t=e.o.prefix,a=e.getTagsRecursive(e.doc.getSelection().focusNode.parentNode),l=t+"active-button "+t+"active";n("."+t+"active-button",e.$btnPane).removeClass(l),n.each(a,function(a,i){var o=e.tagToButton[i.toLowerCase()],r=n("."+t+o+"-button",e.$btnPane);if(r.length>0)r.addClass(l);else try{r=n("."+t+"dropdown ."+t+o+"-dropdown-button",e.$box);var s=r.parent().data("dropdown");n("."+t+s+"-button",e.$box).addClass(l)}catch(c){}})},getTagsRecursive:function(e,t){var a=this;t=t||[];var l=e.tagName;return"DIV"===l?t:("P"===l&&""!==e.style.textAlign&&t.push(e.style.textAlign),n.each(a.tagHandlers,function(n,l){t=t.concat(l(e,a))}),t.push(l),a.getTagsRecursive(e.parentNode,t))},initPlugins:function(){var e=this;e.loadedPlugins=[],n.each(n.trumbowyg.plugins,function(t,a){(!a.shouldInit||a.shouldInit(e))&&(a.init(e),a.tagHandler&&e.tagHandlers.push(a.tagHandler),e.loadedPlugins.push(a))})},destroyPlugins:function(){n.each(this.loadedPlugins,function(e,t){t.destroy&&t.destroy()})}}}(navigator,window,document,jQuery);

//# sourceMappingURL=plugins.min.js.map